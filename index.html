<script type="module">
  import { createChat } from "https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js";

  createChat({
    webhookUrl: "https://conner1005.app.n8n.cloud/webhook/e76ac4f7-7502-4340-a298-a78f2d08c432/chat",
    mode: "window",
    chatInputPlaceholder: "Nachricht schreibenâ€¦",
    initialMessages: [
      "ðŸ‘‹ Willkommen bei Conar Friseur ðŸ’ˆ\n\nâœ‚ï¸ Ich helfe dir gerne bei:\nâ€¢ Termin buchen / Ã¤ndern / stornieren\nâ€¢ Infos zu Ã–ffnungszeiten & Team"
    ]
  });

  // CSS immer zuletzt injizieren (um n8n-CSS sicher zu schlagen)
  const css = `
  #n8n-chat, #n8n-chat * { font-family: inherit !important; }

  /* KOMPLETTES Chat-Panel dunkelgrau */
  #n8n-chat .chat-window,
  #n8n-chat main.chat-layout.chat-wrapper,
  #n8n-chat .chat-layout,
  #n8n-chat .chat-wrapper,
  #n8n-chat .chat-body,
  #n8n-chat .chat-messages-list,
  #n8n-chat .chat-footer{
    background: #14161a !important;
    background-color: #14161a !important;
  }

  /* Header komplett weg */
  #n8n-chat .chat-header{ display:none !important; }

  /* Bubbles: beide hellgrau, Text weiÃŸ */
  #n8n-chat .chat-message,
  #n8n-chat .chat-message--bot,
  #n8n-chat .chat-message--user{
    background: #2a2d33 !important;
    color: #ffffff !important;
    border: 1px solid rgba(255,255,255,.16) !important;
    border-radius: 14px !important;
  }

  /* Input (wie bei dir ok) */
  #n8n-chat .chat-input{
    background:#1a1c20 !important;
    border-top:1px solid rgba(255,255,255,.14) !important;
  }
  #n8n-chat .chat-input textarea,
  #n8n-chat .chat-input input{
    background:transparent !important;
    color:#fff !important;
  }
  #n8n-chat .chat-input textarea::placeholder,
  #n8n-chat .chat-input input::placeholder{
    color: rgba(255,255,255,.6) !important;
  }

  /* Floating Button ðŸ’ˆ */
  #n8n-chat .chat-window-toggle{
    background:#1a1c20 !important;
    border:1px solid rgba(255,255,255,.25) !important;
    position:relative !important;
  }
  #n8n-chat .chat-window-toggle svg{ display:none !important; }
  #n8n-chat .chat-window-toggle::after{
    content:"ðŸ’ˆ";
    position:absolute; inset:0;
    display:grid; place-items:center;
    font-size:20px;
  }
  `;

  const style = document.createElement("style");
  style.id = "n8n-overrides";
  style.textContent = css;
  document.head.appendChild(style);

  // Placeholder sicher auf Deutsch setzen (falls Option ignoriert wird)
  const setPH = () => {
    const el = document.querySelector('#n8n-chat textarea, #n8n-chat input[type="text"]');
    if (el) el.setAttribute("placeholder", "Nachricht schreibenâ€¦");
  };
  new MutationObserver(setPH).observe(document.documentElement, { childList:true, subtree:true });
  setPH();
</script>
